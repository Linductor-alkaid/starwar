# 后端项目结构说明

## 目录结构

```
backend/
├── .gitignore                         # Git忽略文件
├── pom.xml                           # Maven依赖配置
├── README.md                         # 项目说明文档
├── 项目结构说明.md                    # 本文件
└── src/
    └── main/
        ├── java/com/starwar/
        │   ├── StarWarApplication.java    # Spring Boot启动类
        │   │
        │   ├── config/                   # 配置类
        │   │   ├── CorsConfig.java       # 跨域配置
        │   │   └── SwaggerConfig.java    # Swagger文档配置
        │   │
        │   ├── controller/               # 控制器层（接收请求）
        │   │   ├── AuthController.java   # 认证控制器
        │   │   ├── UserController.java   # 用户控制器
        │   │   ├── GameController.java   # 游戏控制器
        │   │   └── PostController.java   # 帖子控制器
        │   │
        │   ├── service/                  # 服务层（业务逻辑）
        │   │   ├── UserService.java      # 用户服务接口
        │   │   ├── GameService.java      # 游戏服务接口
        │   │   ├── PostService.java      # 帖子服务接口
        │   │   └── impl/                 # 服务实现类
        │   │       ├── UserServiceImpl.java
        │   │       ├── GameServiceImpl.java
        │   │       └── PostServiceImpl.java
        │   │
        │   ├── mapper/                   # 数据访问层（数据库操作）
        │   │   ├── UserMapper.java       # 用户Mapper接口
        │   │   ├── GameRecordMapper.java # 游戏记录Mapper接口
        │   │   ├── PostMapper.java       # 帖子Mapper接口
        │   │   └── ReplyMapper.java      # 回复Mapper接口
        │   │
        │   ├── entity/                   # 实体类（数据库表对应）
        │   │   ├── User.java             # 用户实体
        │   │   ├── GameRecord.java       # 游戏记录实体
        │   │   ├── Post.java             # 帖子实体
        │   │   └── Reply.java            # 回复实体
        │   │
        │   ├── dto/                      # 数据传输对象（请求参数）
        │   │   ├── RegisterDTO.java      # 注册DTO
        │   │   ├── LoginDTO.java         # 登录DTO
        │   │   ├── GameRecordDTO.java    # 游戏记录DTO
        │   │   ├── PostDTO.java          # 帖子DTO
        │   │   └── ReplyDTO.java         # 回复DTO
        │   │
        │   ├── vo/                       # 视图对象（返回结果）
        │   │   ├── UserVO.java           # 用户VO
        │   │   ├── GameRecordVO.java     # 游戏记录VO
        │   │   ├── PostVO.java           # 帖子VO
        │   │   └── ReplyVO.java          # 回复VO
        │   │
        │   ├── common/                   # 公共类
        │   │   ├── Result.java           # 统一返回结果
        │   │   ├── ResultCode.java       # 返回码枚举
        │   │   ├── PageResult.java       # 分页结果
        │   │   └── GlobalExceptionHandler.java  # 全局异常处理
        │   │
        │   └── util/                     # 工具类
        │       ├── JwtUtil.java          # JWT工具类
        │       └── PasswordUtil.java     # 密码加密工具类
        │
        └── resources/
            ├── application.yml           # Spring Boot配置文件
            └── mapper/                   # MyBatis映射文件（SQL）
                ├── UserMapper.xml
                ├── GameRecordMapper.xml
                ├── PostMapper.xml
                └── ReplyMapper.xml
```

## 各层职责

### Controller层
- 接收HTTP请求
- 参数验证
- 调用Service层
- 返回统一响应

### Service层
- 业务逻辑处理
- 事务管理
- 调用Mapper层
- 数据转换（Entity <-> DTO/VO）

### Mapper层
- 数据库CRUD操作
- 定义SQL语句

### Entity层
- 对应数据库表
- 使用Lombok简化代码

### DTO层
- 数据传输对象
- 用于接收前端请求参数

### VO层
- 视图对象
- 用于返回给前端的数据

### Common层
- 公共类
- 统一返回格式
- 异常处理

### Util层
- 工具类
- 通用功能封装

## 开发规范

### 命名规范
- Controller: XxxController
- Service: XxxService, XxxServiceImpl
- Mapper: XxxMapper
- Entity: 对应数据库表名（首字母大写）
- DTO: XxxDTO
- VO: XxxVO

### 注解使用
- `@RestController`: Controller类
- `@Service`: Service实现类
- `@Mapper`: Mapper接口
- `@Data`: Entity类（Lombok）
- `@Autowired`: 依赖注入

### 异常处理
- 使用GlobalExceptionHandler统一处理
- Service层抛出RuntimeException
- 前端接收统一错误格式

## API设计规范

### URL设计
```
/api/v1/模块/功能
例如：
- POST /api/v1/auth/register    # 注册
- POST /api/v1/auth/login       # 登录
- GET /api/v1/user/info         # 获取用户信息
```

### 响应格式
```json
{
  "code": 200,
  "message": "success",
  "data": {}
}
```

## 数据库设计

- user: 用户表
- game_record: 游戏记录表
- post: 帖子表
- reply: 回复表

详细设计见 `docs/database/init.sql`

## 部署说明

### 开发环境
1. 配置JDK 8
2. 配置MySQL数据库
3. 执行init.sql脚本
4. 修改application.yml中的数据库连接
5. 运行StarWarApplication主类

### 生产环境
1. 打包: `mvn clean package`
2. 部署到Tomcat服务器
3. 配置数据库连接
4. 启动服务

## 常见问题

### 1. 端口被占用
修改 `application.yml` 中的 `server.port`

### 2. 数据库连接失败
检查MySQL服务是否启动，用户名密码是否正确

### 3. MyBatis映射失败
检查mapper.xml文件位置和命名空间是否正确

### 4. Lombok不生效
IDEA需要安装Lombok插件并启用注解处理

## 联系信息

开发团队

